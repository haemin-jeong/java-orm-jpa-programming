# 엔티티 매핑
## 객체와 테이블 매핑

### @Entity
- JPA를 사용해 테이블과 매핑할 클래스에 @Entity 애노테이션을 필수로 붙혀준다.
- public 또는 protected 기본 생성자가 필수로 있어야 한다.
- final 클래스, enum, interface, inner 클래스에 사용할 수 없다.
- 데이터베이스에 저장할 필드에 final을 사용할 수 없다.

#### @Entity 속성
- name
    - `@Entity(name = "Member")`
    - JPA에서 사용할 엔티티 이름을 지정(디폴트 값은 클래스 이름)
    - 클래스 이름이 중복되는 것이 없다면 가급적 기본값을 사용하는 것이 좋다.

### @Table
엔티티와 매핑할 테이블을 지정한다.
```java
@Entity
@Table(name = "USER")
public class Member {
    ...
}
```
#### @Table 속성
- name : 매핑할 데이터베이스 테이블 이름(디폴트 값은 엔티티 이름)
- catalog : 데이터베이스 catalog 매핑
- schema : 데이터베이스 schema 매핑
- uniqueConstraints(DDL) : DDL 생성 시에 유니크 제약 조건 생성

## 데이터베이스 스키마 자동 생성 기능
데이터베이스 방언을 활용해서 각 데이터베이스에 맞는 적절한 DDL을 실행 시점에 자동으로 생성해주는 기능이다. 

### 설정 방법
persistence.xml
```
<property name="hibernate.hbm2ddl.auto" value="create"/>`
```
- create : 기존 테이블을 삭제 후 다시 생성(DROP -> CREATE)
- create-drop : create인데 종료 시점에 DROP
- update : 변경된 부분만 반영
- validate : 엔티티와 테이블이 정상 매핑되었는지만 확인
- none : 사용하지 않는다

### 주의
- 개발 초기 단계에는 create 또는 update
- 테스트 서버에는 update 또는 validate
- 스테이징과 운영서버는 validate 또는 none 

**가급적이면 테스트 서버나 운영 서버에도 직접 스크립트를 짜거나 JPA가 생성해주는 스크립트를 다듬어서 사용하는 것이 좋다.**

## DDL 생성 기능
```java
//제약 조건 추가 : 회원 이름 not null, 길이는 10 초과 X
@Column(unique = true, nullable = false, length = 10)
private String name;
```
DDL을 자동 생성할 때만 사용되고 JPA의 실행 로직에는 영향을 주지 않는다.
